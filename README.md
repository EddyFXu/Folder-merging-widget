# 文件夹合并工具 (Folder Merging Widget)

![Version](https://img.shields.io/badge/version-1.1.0-blue)
![Platform](https://img.shields.io/badge/platform-Windows-lightgrey)
![License](https://img.shields.io/badge/license-MIT-green)

这是一个基于 Python 和 Tkinter 开发的文件夹合并与整理工具。它可以帮助你将多个子文件夹中的文件合并到一个或多个目标文件夹中，并支持按数量分包、自动重命名、冲突处理等功能。

## 📅 版本历史

### v1.1.0 (2026-02-07)
- **新增**: 智能填充逻辑。程序现在会优先填满所有已存在但不满足数量限制的 `Merged_N` 文件夹（包括中间缺失的编号），最大化利用空间。
- **新增**: 应用程序图标。
- **优化**: 配置文件加载逻辑，增强 EXE 兼容性。

### v1.0.0
- 初始版本发布。
- 支持复制/移动模式。
- 支持文件数量分包。
- 支持重命名和冲突处理。

## 功能特性

- **图形化界面 (GUI)**：操作简单直观。
- **文件扫描**：支持递归扫描源文件夹下的所有文件。
- **合并模式**：
  - **复制**：保留源文件，复制到目标位置。
  - **移动**：移动文件到目标位置，并自动清理源目录下的空文件夹。
- **分包功能**：可以设置每个目标文件夹包含的最大文件数（例如每 10000 个文件存入一个新文件夹）。
- **重命名策略**：
  - 保留原名。
  - 使用“父文件夹名_文件名”格式。
  - 使用“自定义前缀 + 序号”格式。
- **冲突处理**：
  - 自动重命名（例如 `file (1).txt`）。
  - 跳过。
  - 覆盖。
- **进度显示**：实时显示扫描和处理进度。
- **配置持久化**：自动记忆上次选择的源/目标文件夹，以及操作模式、重命名规则、冲突处理方式等所有设置，下次启动自动恢复。
- **智能路径设置**：选择源文件夹时，默认将目标文件夹设置为相同路径。
- **断点续传/接续合并**：自动识别目标目录下已存在的 `Merged_N` 文件夹，并从最后一个未满的文件夹继续写入，确保不超过文件数量限制。
  - **及时清理**：在“移动”模式下，文件被移走后会立即尝试删除空的源父目录。
  
  ## 安装与运行
  ### 源码运行
  1. 确保安装 Python 3.x
  2. 安装依赖（标准库，无需额外安装）
  3. 运行：
     ```bash
     python folder_merger.py
     ```

  ### 编译为 EXE
  如果需要生成独立的可执行文件（.exe）：
  1. 安装 PyInstaller：
     ```bash
     pip install pyinstaller
     ```
  2. 执行编译命令：
     ```bash
     pyinstaller --onefile --windowed --name "FolderMerger" folder_merger.py
     ```
  3. 生成的 `FolderMerger.exe` 将在 `dist` 目录下。
  
  **注意**：配置文件 `merger_config.json` 会自动生成在 EXE 文件所在的同级目录中，请确保 EXE 所在目录有读写权限。

  ## 使用方法

### 1. 运行程序

确保已安装 Python，直接双击运行脚本或在命令行输入：

```bash
python folder_merger.py
```

### 2. 操作步骤

1.  **选择源文件夹**：点击“浏览”选择包含要合并文件的顶级文件夹。
2.  **选择目标位置**：选择合并后文件夹存放的父目录（默认为源文件夹同级）。
3.  **合并设置**：
    *   **每个文件夹文件数量限制**：设置合并后的每个子文件夹（如 `Merged_1`, `Merged_2`）容纳的文件数。
    *   **操作模式**：选择“复制”或“移动”。
4.  **文件名处理**：
    *   选择重命名规则和冲突处理方式。
5.  **开始**：点击“开始合并”按钮。

## 测试

本项目包含自动化测试脚本，用于验证核心逻辑：

```bash
python test_merger.py
```

## 注意事项

- **移动模式**会改变源文件结构，请谨慎使用。
- 处理大量文件时（如百万级），扫描阶段可能需要一些时间，请耐心等待。
